using Amazon.Runtime.Internal.Transform;
using Domain.Models.Insurance;
using Domain.Models.KarteInfs;
using Domain.Models.MstItem;
using Domain.Models.OrdInfDetails;
using Domain.Models.Reception;
using Domain.Models.SystemConf;
using Domain.Models.TodayOdr;
using Interactor.MedicalExamination;
using Moq;

namespace UnitTests.Interactor.MedicalExamination;

public class GetCheckedSpecialItemInteractorTest
{
    #region AgeLimitCheck
    [Fact]
    public void AgeLimitCheck_True()
    {
        // Arrange
        int sinDate = 20221111, iBirthDay = 20221201, checkAge = 1;
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        var tenMstItems = new List<TenItemModel>();

        #region Data Example
        //MaxAge = "AA"
        var tenMstAA = new TenItemModel(
            1,
            "140064650",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "AA",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstAA);

        //MaxAge = "B3"
        var tenMstB3 = new TenItemModel(
            1,
            "629901101",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "B3",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstB3);

        //MaxAge = "B6"
        var tenMstB6 = new TenItemModel(
            1,
            "629901201",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "B6",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstB6);

        //MaxAge = "BF"
        var tenMstBF = new TenItemModel(
            1,
            "629901301",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "BF",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstBF);

        //MaxAge = "BK"
        var tenMstBK = new TenItemModel(
            1,
            "629901401",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "BK",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstBK);

        //MaxAge = "AE"
        var tenMstAE = new TenItemModel(
            1,
            "629901501",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "AE",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstAE);

        //MaxAge = "MG"
        var tenMstMG = new TenItemModel(
            1,
            "629901601",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "MG",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstMG);

        //MaxAge = "MG"
        var tenMstOther = new TenItemModel(
            1,
            "620507802",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "30",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstOther);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetailAA = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "140064650",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetailAA);

        var odrDetailB3 = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "629901101",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetailB3);

        var odrDetailB6 = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901201",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailB6);

        var odrDetailBF = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901301",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailBF);

        var odrDetailBK = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901401",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailBK);

        var odrDetailAE = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901501",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailAE);

        var odrDetailMG = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901601",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailMG);

        var odrDetailOrther = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "620507802",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailOrther);
        #endregion  

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.AgeLimitCheck(sinDate, iBirthDay, checkAge, tenMstItems, odrDetails);

        // Assert
        Assert.True(!output.Any());
    }

    [Fact]
    public void AgeLimitCheck_MaxAge_WithAgeDiffer0()
    {
        // Arrange
        int sinDate = 20221111, iBirthDay = 19930903, checkAge = 29;
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        var tenMstItems = new List<TenItemModel>();

        #region Data Example
        //MaxAge = "AA"
        var tenMstAA = new TenItemModel(
            1,
            "140064650",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "15",
            "AA",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstAA);

        //MaxAge = "B3"
        var tenMstB3 = new TenItemModel(
            1,
            "629901101",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "15",
            "B3",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstB3);

        //MaxAge = "B6"
        var tenMstB6 = new TenItemModel(
            1,
            "629901201",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "15",
            "B6",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstB6);

        //MaxAge = "BF"
        var tenMstBF = new TenItemModel(
            1,
            "629901301",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "15",
            "BF",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstBF);

        //MaxAge = "BK"
        var tenMstBK = new TenItemModel(
            1,
            "629901401",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "15",
            "BK",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstBK);

        //MaxAge = "AE"
        var tenMstAE = new TenItemModel(
            1,
            "629901501",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "15",
            "AE",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstAE);

        //MaxAge = "MG"
        var tenMstMG = new TenItemModel(
            1,
            "629901601",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "15",
            "MG",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstMG);

        //MaxAge = "MG"
        var tenMstOther = new TenItemModel(
            1,
            "620507802",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "15",
            "29",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstOther);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetailAA = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "140064650",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetailAA);

        var odrDetailB3 = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "629901101",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetailB3);

        var odrDetailB6 = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901201",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailB6);

        var odrDetailBF = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901301",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailBF);

        var odrDetailBK = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901401",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailBK);

        var odrDetailAE = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901501",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailAE);

        var odrDetailMG = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901601",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailMG);

        var odrDetailOrther = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "620507802",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailOrther);
        #endregion  

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.AgeLimitCheck(sinDate, iBirthDay, checkAge, tenMstItems, odrDetails);

        // Assert
        Assert.True(output.Count == odrDetails.Count);
    }

    [Fact]
    public void AgeLimitCheck_MinAge_WithAgeDiffer0()
    {
        // Arrange
        int sinDate = 20221111, iBirthDay = 20221221, checkAge = 1;
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        var tenMstItems = new List<TenItemModel>();

        #region Data Example
        //MaxAge = "AA"
        var tenMstAA = new TenItemModel(
            1,
            "140064650",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "AA",
            "15",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstAA);

        //MaxAge = "B3"
        var tenMstB3 = new TenItemModel(
            1,
            "629901101",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "B3",
            "15",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstB3);

        //MaxAge = "B6"
        var tenMstB6 = new TenItemModel(
            1,
            "629901201",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "B6",
            "15",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstB6);

        //MaxAge = "BF"
        var tenMstBF = new TenItemModel(
            1,
            "629901301",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "BF",
            "15",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstBF);

        //MaxAge = "BK"
        var tenMstBK = new TenItemModel(
            1,
            "629901401",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "BK",
            "15",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstBK);

        //MaxAge = "AE"
        var tenMstAE = new TenItemModel(
            1,
            "629901501",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "AE",
            "15",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstAE);

        //MaxAge = "MG"
        var tenMstMG = new TenItemModel(
            1,
            "629901601",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "MG",
            "15",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstMG);

        //MaxAge = "MG"
        var tenMstOther = new TenItemModel(
            1,
            "620507802",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "15",
            "30",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstOther);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetailAA = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "140064650",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetailAA);

        var odrDetailB3 = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "629901101",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetailB3);

        var odrDetailB6 = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901201",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailB6);

        var odrDetailBF = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901301",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailBF);

        var odrDetailBK = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901401",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailBK);

        var odrDetailAE = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901501",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailAE);

        var odrDetailMG = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901601",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailMG);

        var odrDetailOrther = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "620507802",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailOrther);
        #endregion  

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.AgeLimitCheck(sinDate, iBirthDay, checkAge, tenMstItems, odrDetails);

        // Assert
        Assert.True(output.Count == odrDetails.Count);
    }

    [Fact]
    public void AgeLimitCheck_MaxAge_WithMinAgeEqual0()
    {
        // Arrange
        int sinDate = 20221111, iBirthDay = 19930903, checkAge = 29;
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        var tenMstItems = new List<TenItemModel>();

        #region Data Example
        //MaxAge = "AA"
        var tenMstAA = new TenItemModel(
            1,
            "140064650",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "AA",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstAA);

        //MaxAge = "B3"
        var tenMstB3 = new TenItemModel(
            1,
            "629901101",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "B3",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstB3);

        //MaxAge = "B6"
        var tenMstB6 = new TenItemModel(
            1,
            "629901201",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "B6",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstB6);

        //MaxAge = "BF"
        var tenMstBF = new TenItemModel(
            1,
            "629901301",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "BF",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstBF);

        //MaxAge = "BK"
        var tenMstBK = new TenItemModel(
            1,
            "629901401",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "BK",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstBK);

        //MaxAge = "AE"
        var tenMstAE = new TenItemModel(
            1,
            "629901501",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "AE",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstAE);

        //MaxAge = "MG"
        var tenMstMG = new TenItemModel(
            1,
            "629901601",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "MG",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstMG);

        //MaxAge = "MG"
        var tenMstOther = new TenItemModel(
            1,
            "620507802",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "29",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstOther);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetailAA = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "140064650",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetailAA);

        var odrDetailB3 = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "629901101",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetailB3);

        var odrDetailB6 = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901201",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailB6);

        var odrDetailBF = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901301",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailBF);

        var odrDetailBK = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901401",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailBK);

        var odrDetailAE = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901501",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailAE);

        var odrDetailMG = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901601",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailMG);

        var odrDetailOrther = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "620507802",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailOrther);
        #endregion  

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.AgeLimitCheck(sinDate, iBirthDay, checkAge, tenMstItems, odrDetails);

        // Assert
        Assert.True(output.Count == odrDetails.Count);
    }

    [Fact]
    public void AgeLimitCheck_MinAge_WithMaxAgeEqual0()
    {
        // Arrange
        int sinDate = 20221111, iBirthDay = 20221221, checkAge = 1;
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        var tenMstItems = new List<TenItemModel>();

        #region Data Example
        //MaxAge = "AA"
        var tenMstAA = new TenItemModel(
            1,
            "140064650",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "AA",
            "0",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstAA);

        //MaxAge = "B3"
        var tenMstB3 = new TenItemModel(
            1,
            "629901101",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "B3",
            "0",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstB3);

        //MaxAge = "B6"
        var tenMstB6 = new TenItemModel(
            1,
            "629901201",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "B6",
            "0",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstB6);

        //MaxAge = "BF"
        var tenMstBF = new TenItemModel(
            1,
            "629901301",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "BF",
            "0",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstBF);

        //MaxAge = "BK"
        var tenMstBK = new TenItemModel(
            1,
            "629901401",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "BK",
            "0",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstBK);

        //MaxAge = "AE"
        var tenMstAE = new TenItemModel(
            1,
            "629901501",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "AE",
            "0",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstAE);

        //MaxAge = "MG"
        var tenMstMG = new TenItemModel(
            1,
            "629901601",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "MG",
            "0",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstMG);

        //MaxAge = "MG"
        var tenMstOther = new TenItemModel(
            1,
            "620507802",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "15",
            "0",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstOther);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetailAA = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "140064650",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetailAA);

        var odrDetailB3 = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "629901101",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetailB3);

        var odrDetailB6 = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901201",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailB6);

        var odrDetailBF = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901301",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailBF);

        var odrDetailBK = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901401",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailBK);

        var odrDetailAE = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901501",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailAE);

        var odrDetailMG = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "629901601",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailMG);

        var odrDetailOrther = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "620507802",
           "腎盂洗浄（両）",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetailOrther);
        #endregion  

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.AgeLimitCheck(sinDate, iBirthDay, checkAge, tenMstItems, odrDetails);

        // Assert
        Assert.True(output.Count == odrDetails.Count);
    }
    #endregion

    #region ExpiredCheck
    [Fact]
    public void ExpiredCheck_True()
    {
        // Arrange
        var sinDate = 20221101;
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        var tenMstItems = new List<TenItemModel>();
        var tenMstError = new TenItemModel(
            1,
            "140064650",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "00",
            "AA",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstError);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetail = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "140037030",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail);

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.ExpiredCheck(sinDate, tenMstItems, odrDetails);

        // Assert
        Assert.True(!output.Any());
    }

    [Fact]
    public void ExpiredCheck_MinStartDate()
    {
        // Arrange
        var sinDate = 20220101;
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        var tenMstItems = new List<TenItemModel>();
        var tenMstError = new TenItemModel(
            1,
            "140064650",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "00",
            "AA",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstError);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetail = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "140037030",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail);

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.ExpiredCheck(sinDate, tenMstItems, odrDetails);

        // Assert
        Assert.True(output.Any());
    }

    [Fact]
    public void ExpiredCheck_MaxEndDate()
    {
        // Arrange
        var sinDate = 20221101;
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        var tenMstItems = new List<TenItemModel>();
        var tenMstError = new TenItemModel(
            1,
            "140064650",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            20221001,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "00",
            "AA",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstError);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetail = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "140037030",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail);

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.ExpiredCheck(sinDate, tenMstItems, odrDetails);

        // Assert
        Assert.True(output.Any());
    }
    #endregion

    #region DuplicateCheck
    [Fact]
    public void DuplicateCheck_True()
    {
        // Arrange
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        var tenMstItems = new List<TenItemModel>();
        var tenMstError = new TenItemModel(
            1,
            "140064650",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "00",
            "AA",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstError);

        var odrDetails = new List<OrdInfDetailModel>();

        var odrDetail1 = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "140037030",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail1);

        var odrDetail2 = new OrdInfDetailModel(
           1,
           200219890,
           1,
           1,
           1,
           1,
           20221111,
           20,
           "140038410",
           "ストーマ処置２",
           120,
           "",
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           "",
           0,
           "3122007F2",
           "",
           0,
           DateTime.MinValue,
           0,
           "",
           "",
           "",
           "",
           "",
           "",
           0,
           "",
           0,
           0,
           false,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           "",
           new(),
           0,
           0,
           string.Empty,
           string.Empty
           );
        odrDetails.Add(odrDetail2);

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.DuplicateCheck(tenMstItems, odrDetails);

        // Assert
        Assert.True(!output.Any());
    }

    [Fact]
    public void DuplicateCheck_Fail()
    {
        // Arrange
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        var tenMstItems = new List<TenItemModel>();
        var tenMstError = new TenItemModel(
            1,
            "140064650",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "00",
            "AA",
            "140064650",
            0,
            0
            );
        tenMstItems.Add(tenMstError);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetail = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            1,
            20221111,
            20,
            "140064650",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail);
        odrDetails.Add(odrDetail);

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.DuplicateCheck(tenMstItems, odrDetails);

        // Assert
        Assert.True(output.Any());
    }
    #endregion

    #region ItemCommentCheck
    [Fact]
    public void ItemCommentCheck_True()
    {
        // Arrange
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();
        var items = new Dictionary<string, string>()
        {
            new ("140038410", "ストーマ処置２"),
            new("140039650", "人工呼吸（鼻マスク式人工呼吸器）（５時間超）")
        };

        var allCmtCheckMst = new List<ItemCmtModel>()
        {
            new ItemCmtModel ("140038410", "comment abc", 0),
            new ItemCmtModel ("140039650", "comment abc", 1)
        };

        var karteInf = new KarteInfModel(1, 901072057, 1, 1, 1, 20221111, "comment abc", 0, "abc", DateTime.MinValue, DateTime.MinValue, "abc");

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output1 = interactor.ItemCommentCheck(items, allCmtCheckMst, karteInf);

        var output2 = interactor.ItemCommentCheck(items, new(), karteInf);

        // Assert
        Assert.True(!output1.Any() && !output2.Any());
    }

    [Fact]
    public void ItemCommentCheck_Fail()
    {
        // Arrange
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();
        var items = new Dictionary<string, string>()
        {
            new ("140038410", "ストーマ処置２"),
            new("140039650", "人工呼吸（鼻マスク式人工呼吸器）（５時間超）")
        };

        var allCmtCheckMst = new List<ItemCmtModel>()
        {
            new ItemCmtModel ("140038410", "comment abc", 0),
            new ItemCmtModel ("140039650", "comment bcd", 1)
        };

        var karteInf = new KarteInfModel(1, 901072057, 1, 1, 1, 20221111, "comment abc", 0, "abc", DateTime.MinValue, DateTime.MinValue, "abc");

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.ItemCommentCheck(items, allCmtCheckMst, karteInf);

        // Assert
        Assert.True(output.Any());
    }
    #endregion

    #region CalculationCountCheck
    [Fact]
    public void CalculationCountCheck_UnitCd_997_998()
    {
        // Arrange
        int hpId = 1, sinDate = 20221110;
        long raiinNo = 400201159, ptId = 54109;
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        #region Data Example
        var tenMstItems = new List<TenItemModel>();
        var tenMst1 = new TenItemModel(
            1,
            "111000110",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "AA",
            "111000110",
            0,
            0
            );
        tenMstItems.Add(tenMst1);

        var tenMst2 = new TenItemModel(
            1,
            "111013850",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "B3",
            "111013850",
            0,
            0
            );
        tenMstItems.Add(tenMst2);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetail1 = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            ptId,
            20221111,
            20,
            "111000110",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail1);

        var odrDetail2 = new OrdInfDetailModel(
            1,
            200219890,
            2,
            1,
            1,
            ptId,
            20221111,
            20,
            "111013850",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail2);

        var santeiTenMsts = new List<TenItemModel>();
        santeiTenMsts.Add(tenMst1);
        santeiTenMsts.Add(tenMst2);

        var densiSanteiKaisuModels = new List<DensiSanteiKaisuModel>();

        var densiSanteiKaisuModel1 = new DensiSanteiKaisuModel(
                1,
                1,
                "111000110",
                997,
                10,
                0,
                20220101,
                99999999,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            );

        var densiSanteiKaisuModel2 = new DensiSanteiKaisuModel(
               1,
               1,
               "111013850",
               998,
               10,
               0,
               20220101,
               99999999,
               1,
               1,
               1,
               1,
               1,
               1,
               2
           );
        densiSanteiKaisuModels.Add(densiSanteiKaisuModel1);
        densiSanteiKaisuModels.Add(densiSanteiKaisuModel2);

        var itemGrpMsts = new List<ItemGrpMstModel>();

        var itemGrpMst1 = new ItemGrpMstModel(
                1,
                1,
                1,
                20220101,
                99999999,
                "111000110",
                1
            );

        var itemGrpMst2 = new ItemGrpMstModel(
                1,
                1,
                2,
                20220101,
                99999999,
                "111013850",
                1
           );
        itemGrpMsts.Add(itemGrpMst1);
        itemGrpMsts.Add(itemGrpMst2);

        var hokenIds = new List<(long rpno, long edano, int hokenId)> { new(1, 1, 10), new(2, 1, 20) };
        #endregion

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.CalculationCountCheck(hpId, sinDate, raiinNo, ptId, santeiTenMsts, densiSanteiKaisuModels, tenMstItems, odrDetails, itemGrpMsts, hokenIds);

        // Assert
        Assert.True(output.Count == odrDetails.Count);
    }

    [Fact]
    public void CalculationCountCheck_UnitCd_Other()
    {
        // Arrange
        int hpId = 1, sinDate = 20221110;
        long raiinNo = 400201159, ptId = 54109;
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        #region Data Example
        var tenMstItems = new List<TenItemModel>();
        var tenMst1 = new TenItemModel(
            1,
            "111000110",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "AA",
            "111000110",
            0,
            0
            );
        tenMstItems.Add(tenMst1);

        var tenMst2 = new TenItemModel(
            1,
            "111013850",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "B3",
            "111013850",
            0,
            0
            );
        tenMstItems.Add(tenMst2);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetail1 = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            ptId,
            20221111,
            20,
            "111000110",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail1);

        var odrDetail2 = new OrdInfDetailModel(
            1,
            200219890,
            2,
            1,
            1,
            ptId,
            20221111,
            20,
            "111013850",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail2);

        var santeiTenMsts = new List<TenItemModel>();
        santeiTenMsts.Add(tenMst1);
        santeiTenMsts.Add(tenMst2);

        var densiSanteiKaisuModels = new List<DensiSanteiKaisuModel>();

        var densiSanteiKaisuModel1 = new DensiSanteiKaisuModel(
                1,
                1,
                "111000110",
                4,
                10,
                0,
                20220101,
                99999999,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            );

        var densiSanteiKaisuModel2 = new DensiSanteiKaisuModel(
               1,
               1,
               "111013850",
               5,
               10,
               0,
               20220101,
               99999999,
               1,
               1,
               1,
               1,
               1,
               1,
               2
           );
        densiSanteiKaisuModels.Add(densiSanteiKaisuModel1);
        densiSanteiKaisuModels.Add(densiSanteiKaisuModel2);

        var itemGrpMsts = new List<ItemGrpMstModel>();

        var itemGrpMst1 = new ItemGrpMstModel(
                1,
                1,
                1,
                20220101,
                99999999,
                "111000110",
                1
            );

        var itemGrpMst2 = new ItemGrpMstModel(
                1,
                1,
                2,
                20220101,
                99999999,
                "111013850",
                1
           );
        itemGrpMsts.Add(itemGrpMst1);
        itemGrpMsts.Add(itemGrpMst2);

        var hokenIds = new List<(long rpno, long edano, int hokenId)> { new(1, 1, 10), new(2, 1, 20) };
        #endregion

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.CalculationCountCheck(hpId, sinDate, raiinNo, ptId, santeiTenMsts, densiSanteiKaisuModels, tenMstItems, odrDetails, itemGrpMsts, hokenIds);

        // Assert
        Assert.True(output.Count == odrDetails.Count);
    }

    [Fact]
    public void CalculationCountCheck_UnitCd_Other_StartDateMoreThan0()
    {
        // Arrange
        int hpId = 1, sinDate = 20221110;
        long raiinNo = 400201159, ptId = 54109;
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        #region Data Example
        var tenMstItems = new List<TenItemModel>();
        var tenMst1 = new TenItemModel(
            1,
            "111000110",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "AA",
            "111000110",
            0,
            0
            );
        tenMstItems.Add(tenMst1);

        var tenMst2 = new TenItemModel(
            1,
            "111013850",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "B3",
            "111013850",
            0,
            0
            );
        tenMstItems.Add(tenMst2);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetail1 = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            ptId,
            20221111,
            20,
            "111000110",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail1);

        var odrDetail2 = new OrdInfDetailModel(
            1,
            200219890,
            2,
            1,
            1,
            ptId,
            20221111,
            20,
            "111013850",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail2);

        var santeiTenMsts = new List<TenItemModel>();
        santeiTenMsts.Add(tenMst1);
        santeiTenMsts.Add(tenMst2);

        var densiSanteiKaisuModels = new List<DensiSanteiKaisuModel>();

        var densiSanteiKaisuModel1 = new DensiSanteiKaisuModel(
                1,
                1,
                "111000110",
                53,
                10,
                0,
                20220101,
                99999999,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            );

        var densiSanteiKaisuModel2 = new DensiSanteiKaisuModel(
               1,
               1,
               "111013850",
               53,
               10,
               0,
               20220101,
               99999999,
               1,
               1,
               1,
               1,
               1,
               1,
               2
           );
        densiSanteiKaisuModels.Add(densiSanteiKaisuModel1);
        densiSanteiKaisuModels.Add(densiSanteiKaisuModel2);

        var itemGrpMsts = new List<ItemGrpMstModel>();

        var itemGrpMst1 = new ItemGrpMstModel(
                1,
                1,
                1,
                20220101,
                99999999,
                "111000110",
                1
            );

        var itemGrpMst2 = new ItemGrpMstModel(
                1,
                1,
                2,
                20220101,
                99999999,
                "111013850",
                1
           );
        itemGrpMsts.Add(itemGrpMst1);
        itemGrpMsts.Add(itemGrpMst2);

        var hokenIds = new List<(long rpno, long edano, int hokenId)> { new(1, 1, 10), new(2, 1, 20) };
        #endregion

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.CalculationCountCheck(hpId, sinDate, raiinNo, ptId, santeiTenMsts, densiSanteiKaisuModels, tenMstItems, odrDetails, itemGrpMsts, hokenIds);

        // Assert
        Assert.True(output.Count == odrDetails.Count);
    }

    [Fact]
    public void CalculationCountCheck_UnitCd_997_998_True()
    {
        // Arrange
        int hpId = 1, sinDate = 20221110;
        long raiinNo = 400201159, ptId = 54109;
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        #region Data Example
        var tenMstItems = new List<TenItemModel>();
        var tenMst1 = new TenItemModel(
            1,
            "1110001112",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "AA",
            "1110001112",
            0,
            0
            );
        tenMstItems.Add(tenMst1);

        var tenMst2 = new TenItemModel(
            1,
            "111013857",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "B3",
            "111013857",
            0,
            0
            );
        tenMstItems.Add(tenMst2);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetail1 = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            ptId,
            20221111,
            20,
            "1110001112",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail1);

        var odrDetail2 = new OrdInfDetailModel(
            1,
            200219890,
            2,
            1,
            1,
            ptId,
            20221111,
            20,
            "111013857",
            "腎盂洗浄（両）",
            120,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail2);

        var santeiTenMsts = new List<TenItemModel>();
        santeiTenMsts.Add(tenMst1);
        santeiTenMsts.Add(tenMst2);

        var densiSanteiKaisuModels = new List<DensiSanteiKaisuModel>();

        var densiSanteiKaisuModel1 = new DensiSanteiKaisuModel(
                1,
                1,
                "1110001112",
                997,
                10,
                0,
                20220101,
                99999999,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            );

        var densiSanteiKaisuModel2 = new DensiSanteiKaisuModel(
               1,
               1,
               "111013857",
               998,
               10,
               0,
               20220101,
               99999999,
               1,
               1,
               1,
               1,
               1,
               1,
               2
           );
        densiSanteiKaisuModels.Add(densiSanteiKaisuModel1);
        densiSanteiKaisuModels.Add(densiSanteiKaisuModel2);

        var itemGrpMsts = new List<ItemGrpMstModel>();

        var itemGrpMst1 = new ItemGrpMstModel(
                1,
                1,
                1,
                20220101,
                99999999,
                "1110001112",
                1
            );

        var itemGrpMst2 = new ItemGrpMstModel(
                1,
                1,
                2,
                20220101,
                99999999,
                "111013857",
                1
           );
        itemGrpMsts.Add(itemGrpMst1);
        itemGrpMsts.Add(itemGrpMst2);

        var hokenIds = new List<(long rpno, long edano, int hokenId)> { new(1, 1, 10), new(2, 1, 20) };
        #endregion

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.CalculationCountCheck(hpId, sinDate, raiinNo, ptId, santeiTenMsts, densiSanteiKaisuModels, tenMstItems, odrDetails, itemGrpMsts, hokenIds);

        // Assert
        Assert.True(!output.Any());
    }

    [Fact]
    public void CalculationCountCheck_UnitCd_Other_True()
    {
        // Arrange
        int hpId = 1, sinDate = 20221110;
        long raiinNo = 400201159, ptId = 54109;
        var mockMstItemRepo = new Mock<IMstItemRepository>();
        var mockTodayRepo = new Mock<ITodayOdrRepository>();
        var mockInsuranceRepo = new Mock<IInsuranceRepository>();
        var mockSystemConfigRepo = new Mock<ISystemConfRepository>();
        var mockReceptionRepo = new Mock<IReceptionRepository>();

        #region Data Example
        var tenMstItems = new List<TenItemModel>();
        var tenMst1 = new TenItemModel(
            1,
            "111000110",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "AA",
            "111000110",
            0,
            0
            );
        tenMstItems.Add(tenMst1);

        var tenMst2 = new TenItemModel(
            1,
            "111013850",
            0,
            "IMV",
            "ＩＭＶ（５時間超１５日目以降）",
            0,
            0,
            0,
            "",
            99999999,
            0,
            "S",
            0,
            0,
            815,
            3,
            "",
            "",
            0,
            "",
            40,
            "",
            "",
            20220401,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            string.Empty,
            "0",
            "B3",
            "111013850",
            0,
            0
            );
        tenMstItems.Add(tenMst2);

        var odrDetails = new List<OrdInfDetailModel>();
        var odrDetail1 = new OrdInfDetailModel(
            1,
            200219890,
            1,
            1,
            1,
            ptId,
            20221111,
            20,
            "111000110",
            "腎盂洗浄（両）",
            0,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail1);

        var odrDetail2 = new OrdInfDetailModel(
            1,
            200219890,
            2,
            1,
            1,
            ptId,
            20221111,
            20,
            "111013850",
            "腎盂洗浄（両）",
            0,
            "",
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            "",
            0,
            "3122007F2",
            "",
            0,
            DateTime.MinValue,
            0,
            "",
            "",
            "",
            "",
            "",
            "",
            0,
            "",
            0,
            0,
            false,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            "",
            new(),
            0,
            0,
            string.Empty,
            string.Empty
            );
        odrDetails.Add(odrDetail2);

        var santeiTenMsts = new List<TenItemModel>();
        santeiTenMsts.Add(tenMst1);
        santeiTenMsts.Add(tenMst2);

        var densiSanteiKaisuModels = new List<DensiSanteiKaisuModel>();

        var densiSanteiKaisuModel1 = new DensiSanteiKaisuModel(
                1,
                1,
                "111000110",
                53,
                100,
                0,
                20220101,
                99999999,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            );

        var densiSanteiKaisuModel2 = new DensiSanteiKaisuModel(
               1,
               1,
               "111013850",
               53,
               100,
               0,
               20220101,
               99999999,
               1,
               1,
               1,
               1,
               1,
               1,
               2
           );
        densiSanteiKaisuModels.Add(densiSanteiKaisuModel1);
        densiSanteiKaisuModels.Add(densiSanteiKaisuModel2);

        var itemGrpMsts = new List<ItemGrpMstModel>();

        var itemGrpMst1 = new ItemGrpMstModel(
                1,
                1,
                1,
                20220101,
                99999999,
                "111000110",
                1
            );

        var itemGrpMst2 = new ItemGrpMstModel(
                1,
                1,
                2,
                20220101,
                99999999,
                "111013850",
                1
           );
        itemGrpMsts.Add(itemGrpMst1);
        itemGrpMsts.Add(itemGrpMst2);

        var hokenIds = new List<(long rpno, long edano, int hokenId)> { new(1, 1, 10), new(2, 1, 20) };
        #endregion

        var interactor = new CheckedSpecialItemInteractor(mockTodayRepo.Object, mockMstItemRepo.Object, mockInsuranceRepo.Object, mockSystemConfigRepo.Object, mockReceptionRepo.Object);

        // Act
        var output = interactor.CalculationCountCheck(hpId, sinDate, raiinNo, ptId, santeiTenMsts, densiSanteiKaisuModels, tenMstItems, odrDetails, itemGrpMsts, hokenIds);

        // Assert
        Assert.True(!output.Any());
    }
    #endregion
}
